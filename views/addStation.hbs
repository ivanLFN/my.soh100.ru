
<div style="margin-left: 10px; margin-right: 10px">
<div class="commonText">Поставьте маркер на карту и нажмите кнопку "Добавить"</div>
</div>
<br>    
<div id="map" style="width: 100%; height:400px"></div>
<br>
<button class="commonButton" onclick="addLocation()" style="margin-left: 20px;">Добавить</button>
<div style="margin-bottom: 70px"></div>


<script src="https://maps.api.2gis.ru/2.0/loader.js?pkg=full"></script>
<script type="text/javascript">
    let map;
    let marker;
    DG.then(function () {

        map = DG.map('map', {
            center: [55.99, 92.87],
            zoom: 12
        });
        map.on('click', function (ev) {
            if (marker != undefined)
                marker.setLatLng(ev.latlng);
            else {
                marker = DG.marker(ev.latlng).addTo(map);
            }
        });

    });

    function addLocation() {
        if (!marker) {
            alert("Добавьте маркер на карту");
            return;
        }
        const location = { lat: marker._latlng.lat, lng: marker._latlng.lng }
        $.ajax({
            url: `/addPreferredLocation`,
            type: 'POST',
            data: location,
            dataType: 'json',
            success: function (res) {
                alert("Станция добавлена");
                document.location.href = "/";
            }
        });
    }
</script>